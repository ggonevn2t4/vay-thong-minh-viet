import { LoanProductType, CustomQuestionForm } from '@/types/loan-application-flow';

// Optimized questionnaire structure with conditional logic and smart categorization
export interface OptimizedQuestion {
  id: string;
  type: 'text' | 'number' | 'select' | 'textarea' | 'checkbox' | 'radio' | 'date' | 'slider' | 'currency' | 'phone' | 'email' | 'id_number';
  label: string;
  placeholder?: string;
  required: boolean;
  validation?: {
    min?: number;
    max?: number;
    pattern?: string;
    message?: string;
    maxLength?: number;
    minLength?: number;
  };
  options?: string[];
  category: 'basic' | 'financial' | 'employment' | 'credit' | 'product_specific' | 'additional' | 'collateral' | 'family';
  priority: 'high' | 'medium' | 'low'; // For progressive disclosure
  dependsOn?: string; // Field ID that this question depends on
  showWhen?: (value: any) => boolean; // Conditional logic
  helpText?: string; // Additional guidance for users
  icon?: string; // Icon for visual enhancement
  sliderConfig?: {
    min: number;
    max: number;
    step: number;
    marks?: { value: number; label: string }[];
  };
  conditionalSections?: {
    condition: (value: any) => boolean;
    questions: OptimizedQuestion[];
  }[];
}

export interface OptimizedQuestionForm {
  productType: LoanProductType;
  title: string;
  description: string;
  estimatedTime: string; // "5-7 ph√∫t"
  categories: {
    id: string;
    name: string;
    description: string;
    icon: string;
    questions: OptimizedQuestion[];
  }[];
  smartValidation: {
    creditScoreEstimation: boolean;
    incomeVerification: boolean;
    riskAssessment: boolean;
  };
}

// Credit Card Questionnaire (Optimized)
const creditCardQuestionnaire: OptimizedQuestionForm = {
  productType: 'credit_loan',
  title: 'ƒêƒÉng k√Ω Th·∫ª T√≠n D·ª•ng',
  description: 'Ho√†n th√†nh th√¥ng tin ƒë·ªÉ nh·∫≠n ƒë·ªÅ xu·∫•t th·∫ª t√≠n d·ª•ng ph√π h·ª£p nh·∫•t',
  estimatedTime: '5-7 ph√∫t',
  categories: [
    {
      id: 'product_specific',
      name: 'Th√¥ng tin th·∫ª mong mu·ªën',
      description: 'Cho ch√∫ng t√¥i bi·∫øt lo·∫°i th·∫ª b·∫°n quan t√¢m',
      icon: 'üí≥',
      questions: [
        {
          id: 'desired_credit_limit',
          type: 'select',
          label: 'H·∫°n m·ª©c th·∫ª mong mu·ªën',
          required: true,
          options: [
            '5-10 tri·ªáu VNƒê',
            '10-20 tri·ªáu VNƒê', 
            '20-50 tri·ªáu VNƒê',
            '50-100 tri·ªáu VNƒê',
            'Tr√™n 100 tri·ªáu VNƒê'
          ],
          category: 'product_specific',
          priority: 'high',
          helpText: 'Ch·ªçn m·ª©c h·∫°n m·ª©c ph√π h·ª£p v·ªõi kh·∫£ nƒÉng t√†i ch√≠nh c·ªßa b·∫°n',
          icon: 'üí∞'
        },
        {
          id: 'card_usage_purpose',
          type: 'checkbox',
          label: 'M·ª•c ƒë√≠ch s·ª≠ d·ª•ng th·∫ª ch√≠nh',
          required: true,
          options: [
            'Mua s·∫Øm h√†ng ng√†y',
            'Du l·ªãch trong n∆∞·ªõc',
            'Du l·ªãch qu·ªëc t·∫ø',
            'Thanh to√°n online',
            'R√∫t ti·ªÅn m·∫∑t',
            'T√≠ch ƒëi·ªÉm ƒë·ªïi qu√†'
          ],
          category: 'product_specific',
          priority: 'high',
          helpText: 'Ch·ªçn t·ªëi ƒëa 3 m·ª•c ƒë√≠ch ch√≠nh ƒë·ªÉ nh·∫≠n ƒë·ªÅ xu·∫•t ph√π h·ª£p',
          icon: 'üõçÔ∏è'
        },
        {
          id: 'preferred_card_brand',
          type: 'select',
          label: 'Th∆∞∆°ng hi·ªáu th·∫ª ∆∞u ti√™n',
          required: false,
          options: ['Visa', 'Mastercard', 'JCB', 'Kh√¥ng c√≥ ∆∞u ti√™n ƒë·∫∑c bi·ªát'],
          category: 'product_specific',
          priority: 'medium',
          icon: 'üè∑Ô∏è'
        }
      ]
    },
    {
      id: 'basic',
      name: 'Th√¥ng tin c√° nh√¢n',
      description: 'Th√¥ng tin c∆° b·∫£n ƒë·ªÉ x√°c minh danh t√≠nh',
      icon: 'üë§',
      questions: [
        {
          id: 'full_name',
          type: 'text',
          label: 'H·ªç v√† t√™n',
          placeholder: 'Nguy·ªÖn VƒÉn A',
          required: true,
          category: 'basic',
          priority: 'high',
          validation: {
            pattern: '^[a-zA-Z√Ä-·ªπ\\s]{2,50}$',
            message: 'H·ªç t√™n ph·∫£i t·ª´ 2-50 k√Ω t·ª±, ch·ªâ ch·ª©a ch·ªØ c√°i'
          },
          icon: 'üë§'
        },
        {
          id: 'phone_number',
          type: 'text',
          label: 'S·ªë ƒëi·ªán tho·∫°i',
          placeholder: '0901234567',
          required: true,
          category: 'basic',
          priority: 'high',
          validation: {
            pattern: '^(0|\\+84)[3-9][0-9]{8}$',
            message: 'S·ªë ƒëi·ªán tho·∫°i kh√¥ng h·ª£p l·ªá'
          },
          icon: 'üì±'
        },
        {
          id: 'email',
          type: 'text',
          label: 'Email',
          placeholder: 'example@email.com',
          required: true,
          category: 'basic',
          priority: 'high',
          validation: {
            pattern: '^[\\w-\\.]+@([\\w-]+\\.)+[\\w-]{2,4}$',
            message: 'Email kh√¥ng h·ª£p l·ªá'
          },
          icon: 'üìß'
        },
        {
          id: 'id_number',
          type: 'text',
          label: 'S·ªë CMND/CCCD',
          placeholder: '123456789012',
          required: true,
          category: 'basic',
          priority: 'high',
          validation: {
            pattern: '^[0-9]{9,12}$',
            message: 'CMND/CCCD ph·∫£i c√≥ 9-12 ch·ªØ s·ªë'
          },
          icon: 'üÜî'
        },
        {
          id: 'date_of_birth',
          type: 'date',
          label: 'Ng√†y sinh',
          required: true,
          category: 'basic',
          priority: 'high',
          validation: {
            min: 18, // Minimum age
            max: 65, // Maximum age
            message: 'Tu·ªïi ph·∫£i t·ª´ 18-65'
          },
          icon: 'üìÖ'
        }
      ]
    },
    {
      id: 'financial',
      name: 'Th√¥ng tin t√†i ch√≠nh',
      description: 'Thu nh·∫≠p v√† t√¨nh h√¨nh t√†i ch√≠nh hi·ªán t·∫°i',
      icon: 'üí∞',
      questions: [
        {
          id: 'monthly_income',
          type: 'select',
          label: 'Thu nh·∫≠p h√†ng th√°ng',
          required: true,
          options: [
            'D∆∞·ªõi 10 tri·ªáu VNƒê',
            '10-20 tri·ªáu VNƒê',
            '20-30 tri·ªáu VNƒê',
            '30-50 tri·ªáu VNƒê',
            '50-100 tri·ªáu VNƒê',
            'Tr√™n 100 tri·ªáu VNƒê'
          ],
          category: 'financial',
          priority: 'high',
          helpText: 'Bao g·ªìm l∆∞∆°ng, kinh doanh v√† c√°c kho·∫£n thu nh·∫≠p kh√°c',
          icon: 'üíµ'
        },
        {
          id: 'income_stability',
          type: 'select',
          label: 'T√≠nh ·ªïn ƒë·ªãnh c·ªßa thu nh·∫≠p',
          required: true,
          options: [
            'R·∫•t ·ªïn ƒë·ªãnh (l∆∞∆°ng c·ªë ƒë·ªãnh)',
            '·ªîn ƒë·ªãnh (c√≥ bi·∫øn ƒë·ªông nh·∫π)',
            'Kh√¥ng ·ªïn ƒë·ªãnh (thu nh·∫≠p theo d·ª± √°n)',
            'M·ªõi b·∫Øt ƒë·∫ßu c√≥ thu nh·∫≠p'
          ],
          category: 'financial',
          priority: 'high',
          icon: 'üìä'
        },
        {
          id: 'monthly_expenses',
          type: 'select',
          label: 'Chi ph√≠ sinh ho·∫°t h√†ng th√°ng',
          required: true,
          options: [
            'D∆∞·ªõi 5 tri·ªáu VNƒê',
            '5-10 tri·ªáu VNƒê',
            '10-20 tri·ªáu VNƒê',
            '20-30 tri·ªáu VNƒê',
            'Tr√™n 30 tri·ªáu VNƒê'
          ],
          category: 'financial',
          priority: 'medium',
          helpText: 'Bao g·ªìm ƒÉn u·ªëng, nh√† ·ªü, di chuy·ªÉn, gi·∫£i tr√≠',
          icon: 'üè†'
        }
      ]
    },
    {
      id: 'employment',
      name: 'Th√¥ng tin ngh·ªÅ nghi·ªáp',
      description: 'T√¨nh tr·∫°ng vi·ªác l√†m v√† n∆°i l√†m vi·ªác',
      icon: 'üíº',
      questions: [
        {
          id: 'employment_type',
          type: 'select',
          label: 'Lo·∫°i h√¨nh vi·ªác l√†m',
          required: true,
          options: [
            'Nh√¢n vi√™n ch√≠nh th·ª©c',
            'Nh√¢n vi√™n h·ª£p ƒë·ªìng',
            'Kinh doanh t·ª± do',
            'Freelancer',
            'Sinh vi√™n c√≥ thu nh·∫≠p',
            'Ngh·ªâ h∆∞u c√≥ l∆∞∆°ng h∆∞u'
          ],
          category: 'employment',
          priority: 'high',
          icon: 'üëî'
        },
        {
          id: 'work_experience',
          type: 'select',
          label: 'Kinh nghi·ªám l√†m vi·ªác',
          required: true,
          options: [
            'D∆∞·ªõi 1 nƒÉm',
            '1-3 nƒÉm',
            '3-5 nƒÉm',
            '5-10 nƒÉm',
            'Tr√™n 10 nƒÉm'
          ],
          category: 'employment',
          priority: 'medium',
          icon: '‚è≥'
        },
        {
          id: 'company_type',
          type: 'select',
          label: 'Lo·∫°i doanh nghi·ªáp',
          required: false,
          options: [
            'C√¥ng ty nh√† n∆∞·ªõc',
            'C√¥ng ty t∆∞ nh√¢n',
            'C√¥ng ty n∆∞·ªõc ngo√†i',
            'Doanh nghi·ªáp t∆∞ nh√¢n',
            'C∆° quan ch√≠nh ph·ªß',
            'T·ªï ch·ª©c phi l·ª£i nhu·∫≠n'
          ],
          category: 'employment',
          priority: 'low',
          dependsOn: 'employment_type',
          showWhen: (value) => ['Nh√¢n vi√™n ch√≠nh th·ª©c', 'Nh√¢n vi√™n h·ª£p ƒë·ªìng'].includes(value),
          icon: 'üè¢'
        }
      ]
    },
    {
      id: 'credit',
      name: 'L·ªãch s·ª≠ t√≠n d·ª•ng',
      description: 'Kinh nghi·ªám s·ª≠ d·ª•ng c√°c s·∫£n ph·∫©m t√≠n d·ª•ng',
      icon: 'üìà',
      questions: [
        {
          id: 'existing_credit_cards',
          type: 'select',
          label: 'S·ªë th·∫ª t√≠n d·ª•ng hi·ªán c√≥',
          required: true,
          options: [
            'Ch∆∞a c√≥ th·∫ª n√†o',
            '1 th·∫ª',
            '2-3 th·∫ª',
            '4-5 th·∫ª',
            'Tr√™n 5 th·∫ª'
          ],
          category: 'credit',
          priority: 'high',
          icon: 'üí≥'
        },
        {
          id: 'payment_history',
          type: 'select',
          label: 'L·ªãch s·ª≠ thanh to√°n',
          required: true,
          options: [
            'Lu√¥n thanh to√°n ƒë√∫ng h·∫°n',
            'Th·ªânh tho·∫£ng tr·ªÖ h·∫°n',
            'Th∆∞·ªùng xuy√™n tr·ªÖ h·∫°n',
            'Ch∆∞a c√≥ l·ªãch s·ª≠ t√≠n d·ª•ng'
          ],
          category: 'credit',
          priority: 'high',
          dependsOn: 'existing_credit_cards',
          showWhen: (value) => value !== 'Ch∆∞a c√≥ th·∫ª n√†o',
          icon: '‚úÖ'
        },
        {
          id: 'current_debt',
          type: 'select',
          label: 'T·ªïng d∆∞ n·ª£ hi·ªán t·∫°i',
          required: false,
          options: [
            'Kh√¥ng c√≥ n·ª£',
            'D∆∞·ªõi 10 tri·ªáu VNƒê',
            '10-50 tri·ªáu VNƒê',
            '50-100 tri·ªáu VNƒê',
            'Tr√™n 100 tri·ªáu VNƒê'
          ],
          category: 'credit',
          priority: 'medium',
          helpText: 'Bao g·ªìm th·∫ª t√≠n d·ª•ng, vay c√° nh√¢n, vay mua nh√†/xe',
          icon: 'üìã'
        }
      ]
    }
  ],
  smartValidation: {
    creditScoreEstimation: true,
    incomeVerification: true,
    riskAssessment: true
  }
};

// Mortgage Loan Questionnaire (Optimized)
const mortgageQuestionnaire: OptimizedQuestionForm = {
  productType: 'mortgage_loan',
  title: 'Vay Mua Nh√†/B·∫•t ƒê·ªông S·∫£n',
  description: 'Th√¥ng tin chi ti·∫øt ƒë·ªÉ ƒë√°nh gi√° kh·∫£ nƒÉng vay v√† ƒë·ªÅ xu·∫•t g√≥i vay t·ªëi ∆∞u',
  estimatedTime: '8-12 ph√∫t',
  categories: [
    {
      id: 'product_specific',
      name: 'Th√¥ng tin b·∫•t ƒë·ªông s·∫£n',
      description: 'Chi ti·∫øt v·ªÅ b·∫•t ƒë·ªông s·∫£n b·∫°n mu·ªën mua',
      icon: 'üè†',
      questions: [
        {
          id: 'property_type',
          type: 'select',
          label: 'Lo·∫°i b·∫•t ƒë·ªông s·∫£n',
          required: true,
          options: [
            'CƒÉn h·ªô chung c∆∞',
            'Nh√† ri√™ng/Nh√† ph·ªë',
            'Bi·ªát th·ª±',
            'ƒê·∫•t n·ªÅn',
            'Shophouse',
            'Nh√† x∆∞·ªüng/Kho'
          ],
          category: 'product_specific',
          priority: 'high',
          icon: 'üèòÔ∏è'
        },
        {
          id: 'property_status',
          type: 'select',
          label: 'T√¨nh tr·∫°ng b·∫•t ƒë·ªông s·∫£n',
          required: true,
          options: [
            'ƒê√£ ho√†n th√†nh',
            'ƒêang x√¢y d·ª±ng',
            'Ch∆∞a kh·ªüi c√¥ng',
            'Nh√† c≈© c·∫ßn s·ª≠a ch·ªØa'
          ],
          category: 'product_specific',
          priority: 'high',
          icon: 'üöß'
        },
        {
          id: 'property_value',
          type: 'select',
          label: 'Gi√° tr·ªã b·∫•t ƒë·ªông s·∫£n',
          required: true,
          options: [
            'D∆∞·ªõi 1 t·ª∑ VNƒê',
            '1-2 t·ª∑ VNƒê',
            '2-3 t·ª∑ VNƒê',
            '3-5 t·ª∑ VNƒê',
            '5-10 t·ª∑ VNƒê',
            'Tr√™n 10 t·ª∑ VNƒê'
          ],
          category: 'product_specific',
          priority: 'high',
          helpText: 'Gi√° tr·ªã theo h·ª£p ƒë·ªìng mua b√°n ho·∫∑c ƒë·ªãnh gi√° th·ªã tr∆∞·ªùng',
          icon: 'üí∞'
        },
        {
          id: 'down_payment_percentage',
          type: 'select',
          label: 'T·ª∑ l·ªá v·ªën t·ª± c√≥',
          required: true,
          options: [
            '15-20%',
            '20-30%',
            '30-40%',
            '40-50%',
            'Tr√™n 50%'
          ],
          category: 'product_specific',
          priority: 'high',
          helpText: 'S·ªë ti·ªÅn b·∫°n c√≥ th·ªÉ tr·∫£ tr∆∞·ªõc so v·ªõi gi√° tr·ªã BƒêS',
          icon: 'üìä'
        },
        {
          id: 'loan_term_preference',
          type: 'select',
          label: 'Th·ªùi h·∫°n vay mong mu·ªën',
          required: true,
          options: [
            '5-10 nƒÉm',
            '10-15 nƒÉm',
            '15-20 nƒÉm',
            '20-25 nƒÉm',
            'T·ªëi ƒëa c√≥ th·ªÉ'
          ],
          category: 'product_specific',
          priority: 'high',
          icon: '‚è∞'
        }
      ]
    },
    {
      id: 'financial',
      name: 'T√¨nh h√¨nh t√†i ch√≠nh',
      description: 'Thu nh·∫≠p, t√†i s·∫£n v√† kh·∫£ nƒÉng t√†i ch√≠nh',
      icon: 'üí∞',
      questions: [
        {
          id: 'primary_income',
          type: 'select',
          label: 'Thu nh·∫≠p ch√≠nh h√†ng th√°ng',
          required: true,
          options: [
            '20-30 tri·ªáu VNƒê',
            '30-50 tri·ªáu VNƒê',
            '50-100 tri·ªáu VNƒê',
            '100-200 tri·ªáu VNƒê',
            'Tr√™n 200 tri·ªáu VNƒê'
          ],
          category: 'financial',
          priority: 'high',
          icon: 'üíµ'
        },
        {
          id: 'income_sources',
          type: 'checkbox',
          label: 'Ngu·ªìn thu nh·∫≠p',
          required: true,
          options: [
            'L∆∞∆°ng ch√≠nh th·ª©c',
            'Kinh doanh',
            'Cho thu√™ b·∫•t ƒë·ªông s·∫£n',
            'ƒê·∫ßu t∆∞ ch·ª©ng kho√°n',
            'Thu nh·∫≠p t·ª´ freelance',
            'Ngu·ªìn kh√°c'
          ],
          category: 'financial',
          priority: 'high',
          helpText: 'Ch·ªçn t·∫•t c·∫£ ngu·ªìn thu nh·∫≠p c·ªßa b·∫°n',
          icon: 'üìà'
        },
        {
          id: 'financial_assets',
          type: 'select',
          label: 'T√†i s·∫£n t√†i ch√≠nh hi·ªán c√≥',
          required: false,
          options: [
            'D∆∞·ªõi 100 tri·ªáu VNƒê',
            '100-500 tri·ªáu VNƒê',
            '500 tri·ªáu - 1 t·ª∑ VNƒê',
            '1-2 t·ª∑ VNƒê',
            'Tr√™n 2 t·ª∑ VNƒê'
          ],
          category: 'financial',
          priority: 'medium',
          helpText: 'Ti·ªÅn g·ª≠i, ch·ª©ng kho√°n, b·∫£o hi·ªÉm c√≥ gi√° tr·ªã ho√†n l·∫°i',
          icon: 'üè¶'
        },
        {
          id: 'existing_properties',
          type: 'select',
          label: 'B·∫•t ƒë·ªông s·∫£n hi·ªán c√≥',
          required: false,
          options: [
            'Ch∆∞a c√≥',
            '1 b·∫•t ƒë·ªông s·∫£n',
            '2-3 b·∫•t ƒë·ªông s·∫£n',
            'Tr√™n 3 b·∫•t ƒë·ªông s·∫£n'
          ],
          category: 'financial',
          priority: 'medium',
          icon: 'üè°'
        }
      ]
    },
    {
      id: 'employment',
      name: 'Th√¥ng tin ngh·ªÅ nghi·ªáp',
      description: 'T√¨nh tr·∫°ng c√¥ng vi·ªác v√† thu nh·∫≠p',
      icon: 'üíº',
      questions: [
        {
          id: 'employment_status',
          type: 'select',
          label: 'T√¨nh tr·∫°ng vi·ªác l√†m',
          required: true,
          options: [
            'Nh√¢n vi√™n ch√≠nh th·ª©c',
            'Ch·ªß doanh nghi·ªáp',
            'Gi√°m ƒë·ªëc/Qu·∫£n l√Ω c·∫•p cao',
            'Freelancer/T·ª± do',
            'Ngh·ªâ h∆∞u c√≥ thu nh·∫≠p'
          ],
          category: 'employment',
          priority: 'high',
          icon: 'üëî'
        },
        {
          id: 'job_stability',
          type: 'select',
          label: 'Th·ªùi gian ·ªïn ƒë·ªãnh c√¥ng vi·ªác hi·ªán t·∫°i',
          required: true,
          options: [
            'D∆∞·ªõi 1 nƒÉm',
            '1-2 nƒÉm',
            '2-5 nƒÉm',
            '5-10 nƒÉm',
            'Tr√™n 10 nƒÉm'
          ],
          category: 'employment',
          priority: 'high',
          icon: '‚è≥'
        },
        {
          id: 'industry_type',
          type: 'select',
          label: 'Lƒ©nh v·ª±c c√¥ng vi·ªác',
          required: false,
          options: [
            'Ng√¢n h√†ng/T√†i ch√≠nh',
            'C√¥ng ngh·ªá th√¥ng tin',
            'Y t·∫ø',
            'Gi√°o d·ª•c',
            'B·∫•t ƒë·ªông s·∫£n',
            'S·∫£n xu·∫•t',
            'D·ªãch v·ª•',
            'Kh√°c'
          ],
          category: 'employment',
          priority: 'low',
          icon: 'üè≠'
        }
      ]
    },
    {
      id: 'credit',
      name: 'L·ªãch s·ª≠ t√≠n d·ª•ng',
      description: 'Kinh nghi·ªám vay v·ªën v√† t√≠n d·ª•ng',
      icon: 'üìà',
      questions: [
        {
          id: 'mortgage_experience',
          type: 'select',
          label: 'Kinh nghi·ªám vay mua nh√†',
          required: true,
          options: [
            'L·∫ßn ƒë·∫ßu vay mua nh√†',
            'ƒê√£ t·ª´ng vay mua nh√†',
            'Hi·ªán c√≥ kho·∫£n vay nh√†',
            'ƒê√£ tr·∫£ h·∫øt n·ª£ nh√†'
          ],
          category: 'credit',
          priority: 'high',
          icon: 'üè†'
        },
        {
          id: 'current_debts',
          type: 'select',
          label: 'T·ªïng n·ª£ hi·ªán t·∫°i',
          required: true,
          options: [
            'Kh√¥ng c√≥ n·ª£',
            'D∆∞·ªõi 100 tri·ªáu VNƒê',
            '100-500 tri·ªáu VNƒê',
            '500 tri·ªáu - 1 t·ª∑ VNƒê',
            'Tr√™n 1 t·ª∑ VNƒê'
          ],
          category: 'credit',
          priority: 'high',
          helpText: 'Bao g·ªìm th·∫ª t√≠n d·ª•ng, vay c√° nh√¢n, vay xe, vay nh√† kh√°c',
          icon: 'üìã'
        },
        {
          id: 'credit_score_self_assessment',
          type: 'select',
          label: 'T·ª± ƒë√°nh gi√° m·ª©c ƒë·ªô t√≠n d·ª•ng',
          required: false,
          options: [
            'R·∫•t t·ªët - kh√¥ng n·ª£ x·∫•u',
            'T·ªët - tr·∫£ n·ª£ ƒë√∫ng h·∫°n',
            'Trung b√¨nh - c√≥ tr·ªÖ h·∫°n nh·∫π',
            'C·∫ßn c·∫£i thi·ªán',
            'Kh√¥ng r√µ'
          ],
          category: 'credit',
          priority: 'medium',
          icon: '‚≠ê'
        }
      ]
    }
  ],
  smartValidation: {
    creditScoreEstimation: true,
    incomeVerification: true,
    riskAssessment: true
  }
};

// Car Loan Questionnaire (New)
const carLoanQuestionnaire: OptimizedQuestionForm = {
  productType: 'car_loan',
  title: 'Vay Mua Xe',
  description: 'Th√¥ng tin ƒë·ªÉ t√¨m g√≥i vay xe ph√π h·ª£p v·ªõi nhu c·∫ßu c·ªßa b·∫°n',
  estimatedTime: '4-6 ph√∫t',
  categories: [
    {
      id: 'product_specific',
      name: 'Th√¥ng tin xe mu·ªën mua',
      description: 'Chi ti·∫øt v·ªÅ chi·∫øc xe b·∫°n quan t√¢m',
      icon: 'üöó',
      questions: [
        {
          id: 'car_type',
          type: 'select',
          label: 'Lo·∫°i xe',
          required: true,
          options: [
            'Xe du l·ªãch (sedan)',
            'Xe SUV/CUV',
            'Xe pickup/b√°n t·∫£i',
            'Xe hatchback',
            'Xe th·ªÉ thao',
            'Xe ƒëi·ªán'
          ],
          category: 'product_specific',
          priority: 'high',
          icon: 'üöô'
        },
        {
          id: 'car_condition',
          type: 'select',
          label: 'T√¨nh tr·∫°ng xe',
          required: true,
          options: [
            'Xe m·ªõi 100%',
            'Xe ƒë√£ qua s·ª≠ d·ª•ng (d∆∞·ªõi 5 nƒÉm)',
            'Xe ƒë√£ qua s·ª≠ d·ª•ng (5-10 nƒÉm)',
            'Xe c≈© (tr√™n 10 nƒÉm)'
          ],
          category: 'product_specific',
          priority: 'high',
          icon: 'üîß'
        },
        {
          id: 'car_value',
          type: 'select',
          label: 'Gi√° tr·ªã xe',
          required: true,
          options: [
            'D∆∞·ªõi 500 tri·ªáu VNƒê',
            '500 tri·ªáu - 1 t·ª∑ VNƒê',
            '1-1.5 t·ª∑ VNƒê',
            '1.5-2 t·ª∑ VNƒê',
            'Tr√™n 2 t·ª∑ VNƒê'
          ],
          category: 'product_specific',
          priority: 'high',
          icon: 'üí∞'
        }
      ]
    }
  ],
  smartValidation: {
    creditScoreEstimation: true,
    incomeVerification: false,
    riskAssessment: true
  }
};

// Business Loan Questionnaire (New)
const businessLoanQuestionnaire: OptimizedQuestionForm = {
  productType: 'business_loan',
  title: 'Vay Kinh Doanh',
  description: 'Th√¥ng tin ƒë·ªÉ ƒë√°nh gi√° v√† ƒë·ªÅ xu·∫•t g√≥i vay kinh doanh ph√π h·ª£p',
  estimatedTime: '6-8 ph√∫t',
  categories: [
    {
      id: 'product_specific',
      name: 'Th√¥ng tin kinh doanh',
      description: 'Chi ti·∫øt v·ªÅ doanh nghi·ªáp v√† nhu c·∫ßu vay',
      icon: 'üè¢',
      questions: [
        {
          id: 'business_type',
          type: 'select',
          label: 'Lo·∫°i h√¨nh doanh nghi·ªáp',
          required: true,
          options: [
            'Doanh nghi·ªáp t∆∞ nh√¢n',
            'C√¥ng ty TNHH',
            'C√¥ng ty c·ªï ph·∫ßn',
            'H·ªô kinh doanh c√° th·ªÉ'
          ],
          category: 'product_specific',
          priority: 'high',
          icon: 'üè≠'
        }
      ]
    }
  ],
  smartValidation: {
    creditScoreEstimation: true,
    incomeVerification: true,
    riskAssessment: true
  }
};

// Education Loan Questionnaire (New)
const educationLoanQuestionnaire: OptimizedQuestionForm = {
  productType: 'education_loan',
  title: 'Vay H·ªçc T·∫≠p',
  description: 'Th√¥ng tin ƒë·ªÉ ƒë√°nh gi√° nhu c·∫ßu vay h·ªçc ph√≠ v√† chi ph√≠ h·ªçc t·∫≠p',
  estimatedTime: '4-6 ph√∫t',
  categories: [
    {
      id: 'product_specific',
      name: 'Th√¥ng tin h·ªçc t·∫≠p',
      description: 'Chi ti·∫øt v·ªÅ kh√≥a h·ªçc v√† nhu c·∫ßu t√†i ch√≠nh',
      icon: 'üéì',
      questions: [
        {
          id: 'education_level',
          type: 'select',
          label: 'B·∫≠c h·ªçc',
          required: true,
          options: [
            'ƒê·∫°i h·ªçc',
            'Th·∫°c sƒ©',
            'Ti·∫øn sƒ©',
            'Kh√≥a h·ªçc ngh·ªÅ nghi·ªáp'
          ],
          category: 'product_specific',
          priority: 'high',
          icon: 'üìö'
        }
      ]
    }
  ],
  smartValidation: {
    creditScoreEstimation: false,
    incomeVerification: false,
    riskAssessment: true
  }
};

// Credit Consumer Loan Questionnaire (T√çN CH·∫§P ‚Äì VAY TI√äU D√ôNG)
const creditConsumerLoanQuestionnaire: OptimizedQuestionForm = {
  productType: 'credit_loan',
  title: 'Vay T√≠n Ch·∫•p - Ti√™u D√πng',
  description: 'Ho√†n th√†nh th√¥ng tin ƒë·ªÉ nh·∫≠n ƒë·ªÅ xu·∫•t vay t√≠n ch·∫•p ph√π h·ª£p v·ªõi nhu c·∫ßu c·ªßa b·∫°n',
  estimatedTime: '8-12 ph√∫t',
  categories: [
    {
      id: 'basic',
      name: 'Th√¥ng tin c∆° b·∫£n',
      description: 'Th√¥ng tin c√° nh√¢n v√† li√™n h·ªá',
      icon: 'üë§',
      questions: [
        {
          id: 'full_name',
          type: 'text',
          label: 'H·ªç v√† t√™n',
          placeholder: 'Nguy·ªÖn VƒÉn A',
          required: true,
          category: 'basic',
          priority: 'high',
          validation: {
            pattern: '^[a-zA-Z√Ä-·ªπ\\s]{2,50}$',
            message: 'H·ªç t√™n ph·∫£i t·ª´ 2-50 k√Ω t·ª±, ch·ªâ ch·ª©a ch·ªØ c√°i'
          },
          icon: 'üë§'
        },
        {
          id: 'phone_number',
          type: 'phone',
          label: 'S·ªë ƒëi·ªán tho·∫°i',
          placeholder: '0901234567',
          required: true,
          category: 'basic',
          priority: 'high',
          validation: {
            pattern: '^(0|\\+84)[3-9][0-9]{8}$',
            message: 'S·ªë ƒëi·ªán tho·∫°i kh√¥ng h·ª£p l·ªá'
          },
          icon: 'üì±'
        },
        {
          id: 'email',
          type: 'email',
          label: 'Email',
          placeholder: 'example@email.com',
          required: true,
          category: 'basic',
          priority: 'high',
          validation: {
            pattern: '^[\\w-\\.]+@([\\w-]+\\.)+[\\w-]{2,4}$',
            message: 'Email kh√¥ng h·ª£p l·ªá'
          },
          icon: 'üìß'
        },
        {
          id: 'id_number',
          type: 'id_number',
          label: 'S·ªë CMND/CCCD',
          placeholder: '123456789012',
          required: true,
          category: 'basic',
          priority: 'high',
          validation: {
            pattern: '^[0-9]{9,12}$',
            message: 'CMND/CCCD ph·∫£i c√≥ 9-12 ch·ªØ s·ªë'
          },
          icon: 'üÜî'
        },
        {
          id: 'date_of_birth',
          type: 'date',
          label: 'Ng√†y sinh',
          required: true,
          category: 'basic',
          priority: 'high',
          validation: {
            min: 18,
            max: 65,
            message: 'Tu·ªïi ph·∫£i t·ª´ 18-65'
          },
          icon: 'üìÖ'
        },
        {
          id: 'gender',
          type: 'radio',
          label: 'Gi·ªõi t√≠nh',
          required: true,
          options: ['Nam', 'N·ªØ', 'Kh√°c'],
          category: 'basic',
          priority: 'high',
          icon: 'üë•'
        },
        {
          id: 'marital_status',
          type: 'select',
          label: 'T√¨nh tr·∫°ng h√¥n nh√¢n',
          required: true,
          options: [
            'ƒê·ªôc th√¢n',
            'ƒê√£ k·∫øt h√¥n',
            'Ly h√¥n',
            'G√≥a',
            'S·ªëng chung kh√¥ng ƒëƒÉng k√Ω'
          ],
          category: 'basic',
          priority: 'high',
          icon: 'üíë'
        },
        {
          id: 'education_level',
          type: 'select',
          label: 'Tr√¨nh ƒë·ªô h·ªçc v·∫•n',
          required: true,
          options: [
            'Trung h·ªçc ph·ªï th√¥ng',
            'Trung c·∫•p/Cao ƒë·∫≥ng',
            'ƒê·∫°i h·ªçc',
            'Th·∫°c sƒ©',
            'Ti·∫øn sƒ©'
          ],
          category: 'basic',
          priority: 'medium',
          icon: 'üéì'
        }
      ]
    },
    {
      id: 'financial',
      name: 'Th√¥ng tin t√†i ch√≠nh',
      description: 'Thu nh·∫≠p, chi ph√≠ v√† t√¨nh h√¨nh t√†i ch√≠nh',
      icon: 'üí∞',
      questions: [
        {
          id: 'loan_amount',
          type: 'slider',
          label: 'S·ªë ti·ªÅn vay mong mu·ªën',
          required: true,
          category: 'financial',
          priority: 'high',
          sliderConfig: {
            min: 10000000,
            max: 2000000000,
            step: 5000000,
            marks: [
              { value: 10000000, label: '10 tri·ªáu' },
              { value: 100000000, label: '100 tri·ªáu' },
              { value: 500000000, label: '500 tri·ªáu' },
              { value: 1000000000, label: '1 t·ª∑' },
              { value: 2000000000, label: '2 t·ª∑' }
            ]
          },
          helpText: 'K√©o thanh tr∆∞·ª£t ƒë·ªÉ ch·ªçn s·ªë ti·ªÅn vay ph√π h·ª£p',
          icon: 'üíµ'
        },
        {
          id: 'loan_term',
          type: 'select',
          label: 'Th·ªùi h·∫°n vay',
          required: true,
          options: [
            '3 th√°ng',
            '6 th√°ng',
            '12 th√°ng',
            '18 th√°ng',
            '24 th√°ng',
            '36 th√°ng',
            '48 th√°ng',
            '60 th√°ng'
          ],
          category: 'financial',
          priority: 'high',
          icon: 'üìÖ'
        },
        {
          id: 'monthly_income',
          type: 'currency',
          label: 'Thu nh·∫≠p h√†ng th√°ng',
          placeholder: '20,000,000',
          required: true,
          category: 'financial',
          priority: 'high',
          validation: {
            min: 5000000,
            message: 'Thu nh·∫≠p t·ªëi thi·ªÉu 5 tri·ªáu VNƒê'
          },
          helpText: 'Bao g·ªìm t·∫•t c·∫£ ngu·ªìn thu nh·∫≠p ·ªïn ƒë·ªãnh',
          icon: 'üí∞'
        },
        {
          id: 'income_stability',
          type: 'select',
          label: 'T√≠nh ·ªïn ƒë·ªãnh thu nh·∫≠p',
          required: true,
          options: [
            'R·∫•t ·ªïn ƒë·ªãnh (l∆∞∆°ng c·ªë ƒë·ªãnh t·ª´ 12 th√°ng tr·ªü l√™n)',
            '·ªîn ƒë·ªãnh (l∆∞∆°ng c·ªë ƒë·ªãnh t·ª´ 6-12 th√°ng)',
            'T∆∞∆°ng ƒë·ªëi ·ªïn ƒë·ªãnh (c√≥ bi·∫øn ƒë·ªông nh·∫π)',
            'Kh√¥ng ·ªïn ƒë·ªãnh (thu nh·∫≠p theo d·ª± √°n/m√πa v·ª•)',
            'M·ªõi b·∫Øt ƒë·∫ßu c√≥ thu nh·∫≠p'
          ],
          category: 'financial',
          priority: 'high',
          icon: 'üìä'
        },
        {
          id: 'monthly_expenses',
          type: 'currency',
          label: 'Chi ph√≠ sinh ho·∫°t h√†ng th√°ng',
          placeholder: '10,000,000',
          required: true,
          category: 'financial',
          priority: 'medium',
          validation: {
            max: 50000000,
            message: 'Chi ph√≠ qu√° cao so v·ªõi thu nh·∫≠p'
          },
          helpText: 'Bao g·ªìm ƒÉn u·ªëng, nh√† ·ªü, di chuy·ªÉn, h·ªçc ph√≠, y t·∫ø',
          icon: 'üè†'
        },
        {
          id: 'savings_amount',
          type: 'currency',
          label: 'S·ªë ti·ªÅn ti·∫øt ki·ªám hi·ªán c√≥',
          placeholder: '50,000,000',
          required: false,
          category: 'financial',
          priority: 'medium',
          helpText: 'Ti·ªÅn g·ª≠i ng√¢n h√†ng, ti·ªÅn m·∫∑t, ch·ª©ng kho√°n',
          icon: 'üè¶'
        }
      ]
    },
    {
      id: 'employment',
      name: 'Th√¥ng tin ngh·ªÅ nghi·ªáp',
      description: 'Chi ti·∫øt v·ªÅ c√¥ng vi·ªác v√† thu nh·∫≠p',
      icon: 'üíº',
      questions: [
        {
          id: 'employment_type',
          type: 'select',
          label: 'Lo·∫°i h√¨nh vi·ªác l√†m',
          required: true,
          options: [
            'Nh√¢n vi√™n ch√≠nh th·ª©c (c√≥ h·ª£p ƒë·ªìng lao ƒë·ªông)',
            'Nh√¢n vi√™n h·ª£p ƒë·ªìng (c√≥ th·ªùi h·∫°n)',
            'C√¥ng ch·ª©c/Vi√™n ch·ª©c',
            'Ch·ªß doanh nghi·ªáp/Gi√°m ƒë·ªëc',
            'Kinh doanh t·ª± do/Freelancer',
            'Ngh·ªâ h∆∞u c√≥ l∆∞∆°ng h∆∞u',
            'Sinh vi√™n c√≥ thu nh·∫≠p',
            'Th·∫•t nghi·ªáp/Kh√¥ng c√≥ vi·ªác l√†m'
          ],
          category: 'employment',
          priority: 'high',
          icon: 'üëî'
        },
        {
          id: 'company_name',
          type: 'text',
          label: 'T√™n c√¥ng ty/C∆° quan',
          placeholder: 'C√¥ng ty TNHH ABC',
          required: true,
          category: 'employment',
          priority: 'high',
          dependsOn: 'employment_type',
          showWhen: (value) => !['Kinh doanh t·ª± do/Freelancer', 'Th·∫•t nghi·ªáp/Kh√¥ng c√≥ vi·ªác l√†m'].includes(value),
          validation: {
            minLength: 2,
            maxLength: 100,
            message: 'T√™n c√¥ng ty ph·∫£i t·ª´ 2-100 k√Ω t·ª±'
          },
          icon: 'üè¢'
        },
        {
          id: 'job_position',
          type: 'text',
          label: 'Ch·ª©c v·ª•/V·ªã tr√≠ c√¥ng vi·ªác',
          placeholder: 'Nh√¢n vi√™n k·∫ø to√°n',
          required: true,
          category: 'employment',
          priority: 'high',
          dependsOn: 'employment_type',
          showWhen: (value) => !['Kinh doanh t·ª± do/Freelancer', 'Th·∫•t nghi·ªáp/Kh√¥ng c√≥ vi·ªác l√†m'].includes(value),
          validation: {
            minLength: 2,
            maxLength: 50
          },
          icon: 'üë®‚Äçüíº'
        },
        {
          id: 'work_experience_current_job',
          type: 'select',
          label: 'Th·ªùi gian l√†m vi·ªác t·∫°i c√¥ng ty hi·ªán t·∫°i',
          required: true,
          options: [
            'D∆∞·ªõi 3 th√°ng',
            '3-6 th√°ng',
            '6-12 th√°ng',
            '1-2 nƒÉm',
            '2-5 nƒÉm',
            '5-10 nƒÉm',
            'Tr√™n 10 nƒÉm'
          ],
          category: 'employment',
          priority: 'high',
          dependsOn: 'employment_type',
          showWhen: (value) => !['Kinh doanh t·ª± do/Freelancer', 'Th·∫•t nghi·ªáp/Kh√¥ng c√≥ vi·ªác l√†m'].includes(value),
          icon: '‚è≥'
        },
        {
          id: 'total_work_experience',
          type: 'select',
          label: 'T·ªïng s·ªë nƒÉm kinh nghi·ªám l√†m vi·ªác',
          required: true,
          options: [
            'D∆∞·ªõi 1 nƒÉm',
            '1-3 nƒÉm',
            '3-5 nƒÉm',
            '5-10 nƒÉm',
            '10-15 nƒÉm',
            'Tr√™n 15 nƒÉm'
          ],
          category: 'employment',
          priority: 'medium',
          icon: 'üìà'
        },
        {
          id: 'industry',
          type: 'select',
          label: 'Lƒ©nh v·ª±c ho·∫°t ƒë·ªông',
          required: false,
          options: [
            'Ng√¢n h√†ng/T√†i ch√≠nh/B·∫£o hi·ªÉm',
            'C√¥ng ngh·ªá th√¥ng tin',
            'Vi·ªÖn th√¥ng',
            'Y t·∫ø/D∆∞·ª£c ph·∫©m',
            'Gi√°o d·ª•c/ƒê√†o t·∫°o',
            'B·∫•t ƒë·ªông s·∫£n',
            'X√¢y d·ª±ng',
            'S·∫£n xu·∫•t/Ch·∫ø t·∫°o',
            'Th∆∞∆°ng m·∫°i/B√°n l·∫ª',
            'Du l·ªãch/Nh√† h√†ng/Kh√°ch s·∫°n',
            'V·∫≠n t·∫£i/Logistics',
            'N√¥ng nghi·ªáp/Th·ªßy s·∫£n',
            'D·∫ßu kh√≠/NƒÉng l∆∞·ª£ng',
            'Ch√≠nh ph·ªß/C∆° quan nh√† n∆∞·ªõc',
            'T·ªï ch·ª©c phi l·ª£i nhu·∫≠n',
            'Kh√°c'
          ],
          category: 'employment',
          priority: 'low',
          icon: 'üè≠'
        }
      ]
    },
    {
      id: 'family',
      name: 'Th√¥ng tin gia ƒë√¨nh',
      description: 'Th√¥ng tin v·ªÅ gia ƒë√¨nh v√† ng∆∞·ªùi ph·ª• thu·ªôc',
      icon: 'üë®‚Äçüë©‚Äçüëß‚Äçüë¶',
      questions: [
        {
          id: 'spouse_info',
          type: 'radio',
          label: 'T√¨nh tr·∫°ng v·ª£/ch·ªìng',
          required: true,
          options: [
            'Kh√¥ng c√≥ v·ª£/ch·ªìng',
            'C√≥ v·ª£/ch·ªìng nh∆∞ng kh√¥ng c√≥ thu nh·∫≠p',
            'C√≥ v·ª£/ch·ªìng c√≥ thu nh·∫≠p ·ªïn ƒë·ªãnh',
            'C√≥ v·ª£/ch·ªìng c√≥ thu nh·∫≠p kh√¥ng ·ªïn ƒë·ªãnh'
          ],
          category: 'family',
          priority: 'high',
          dependsOn: 'marital_status',
          showWhen: (value) => ['ƒê√£ k·∫øt h√¥n', 'S·ªëng chung kh√¥ng ƒëƒÉng k√Ω'].includes(value),
          icon: 'üíë'
        },
        {
          id: 'spouse_monthly_income',
          type: 'currency',
          label: 'Thu nh·∫≠p h√†ng th√°ng c·ªßa v·ª£/ch·ªìng',
          placeholder: '15,000,000',
          required: false,
          category: 'family',
          priority: 'medium',
          dependsOn: 'spouse_info',
          showWhen: (value) => ['C√≥ v·ª£/ch·ªìng c√≥ thu nh·∫≠p ·ªïn ƒë·ªãnh', 'C√≥ v·ª£/ch·ªìng c√≥ thu nh·∫≠p kh√¥ng ·ªïn ƒë·ªãnh'].includes(value),
          helpText: 'Thu nh·∫≠p r√≤ng sau thu·∫ø',
          icon: 'üí∞'
        },
        {
          id: 'number_of_dependents',
          type: 'select',
          label: 'S·ªë ng∆∞·ªùi ph·ª• thu·ªôc',
          required: true,
          options: [
            '0 ng∆∞·ªùi',
            '1 ng∆∞·ªùi',
            '2 ng∆∞·ªùi',
            '3 ng∆∞·ªùi',
            '4 ng∆∞·ªùi',
            'Tr√™n 4 ng∆∞·ªùi'
          ],
          category: 'family',
          priority: 'medium',
          helpText: 'Bao g·ªìm con nh·ªè, cha m·∫π gi√†, ng∆∞·ªùi th√¢n c·∫ßn h·ªó tr·ª£ t√†i ch√≠nh',
          icon: 'üë∂'
        },
        {
          id: 'housing_situation',
          type: 'select',
          label: 'T√¨nh tr·∫°ng nh√† ·ªü',
          required: true,
          options: [
            'S·ªü h·ªØu nh√† ri√™ng (kh√¥ng c√≥ n·ª£)',
            'S·ªü h·ªØu nh√† ri√™ng (ƒëang tr·∫£ n·ª£ ng√¢n h√†ng)',
            'Thu√™ nh√†/cƒÉn h·ªô',
            '·ªû c√πng gia ƒë√¨nh/b·ªë m·∫π',
            '·ªû nh√† c√¥ng ty',
            'Kh√°c'
          ],
          category: 'family',
          priority: 'medium',
          icon: 'üè†'
        },
        {
          id: 'monthly_housing_cost',
          type: 'currency',
          label: 'Chi ph√≠ nh√† ·ªü h√†ng th√°ng',
          placeholder: '5,000,000',
          required: false,
          category: 'family',
          priority: 'low',
          dependsOn: 'housing_situation',
          showWhen: (value) => ['S·ªü h·ªØu nh√† ri√™ng (ƒëang tr·∫£ n·ª£ ng√¢n h√†ng)', 'Thu√™ nh√†/cƒÉn h·ªô'].includes(value),
          helpText: 'Ti·ªÅn thu√™ nh√† ho·∫∑c kho·∫£n vay mua nh√† h√†ng th√°ng',
          icon: 'üí≥'
        }
      ]
    },
    {
      id: 'product_specific',
      name: 'M·ª•c ƒë√≠ch vay',
      description: 'Chi ti·∫øt v·ªÅ m·ª•c ƒë√≠ch s·ª≠ d·ª•ng kho·∫£n vay',
      icon: 'üéØ',
      questions: [
        {
          id: 'loan_purpose',
          type: 'select',
          label: 'M·ª•c ƒë√≠ch vay ch√≠nh',
          required: true,
          options: [
            'Ti√™u d√πng c√° nh√¢n/gia ƒë√¨nh',
            'Mua s·∫Øm h√†ng h√≥a cao c·∫•p',
            'Du l·ªãch/Ngh·ªâ d∆∞·ª°ng',
            'Ch·ªØa b·ªánh/Y t·∫ø',
            'H·ªçc t·∫≠p/ƒê√†o t·∫°o',
            'ƒê√°m c∆∞·ªõi/S·ª± ki·ªán gia ƒë√¨nh',
            'S·ª≠a ch·ªØa/C·∫£i t·∫°o nh√† c·ª≠a',
            'Tr·∫£ n·ª£/T√°i c·∫•u tr√∫c n·ª£',
            'Kinh doanh nh·ªè l·∫ª',
            'ƒê·∫ßu t∆∞/Sinh l·ªùi',
            'Kh·∫©n c·∫•p/B·∫•t kh·∫£ kh√°ng',
            'Kh√°c'
          ],
          category: 'product_specific',
          priority: 'high',
          icon: 'üéØ'
        },
        {
          id: 'loan_purpose_detail',
          type: 'textarea',
          label: 'M√¥ t·∫£ chi ti·∫øt m·ª•c ƒë√≠ch vay',
          placeholder: 'Vui l√≤ng m√¥ t·∫£ c·ª• th·ªÉ m·ª•c ƒë√≠ch s·ª≠ d·ª•ng s·ªë ti·ªÅn vay...',
          required: true,
          category: 'product_specific',
          priority: 'high',
          validation: {
            minLength: 10,
            maxLength: 500,
            message: 'M√¥ t·∫£ ph·∫£i t·ª´ 10-500 k√Ω t·ª±'
          },
          helpText: 'M√¥ t·∫£ c√†ng chi ti·∫øt s·∫Ω gi√∫p ng√¢n h√†ng ƒë√°nh gi√° v√† x·ª≠ l√Ω nhanh h∆°n',
          icon: 'üìù'
        },
        {
          id: 'preferred_payment_method',
          type: 'select',
          label: 'Ph∆∞∆°ng th·ª©c tr·∫£ n·ª£ ∆∞u ti√™n',
          required: true,
          options: [
            'Tr·∫£ g·ªëc v√† l√£i ƒë·ªÅu h√†ng th√°ng',
            'Tr·∫£ l√£i h√†ng th√°ng, g·ªëc cu·ªëi k·ª≥',
            'Tr·∫£ n·ª£ theo qu√Ω',
            'Tr·∫£ n·ª£ linh ho·∫°t theo thu nh·∫≠p',
            'Kh√°c'
          ],
          category: 'product_specific',
          priority: 'medium',
          icon: 'üí≥'
        },
        {
          id: 'urgency_level',
          type: 'select',
          label: 'M·ª©c ƒë·ªô c·∫ßn ti·ªÅn',
          required: true,
          options: [
            'R·∫•t g·∫•p (trong 1-2 ng√†y)',
            'G·∫•p (trong 1 tu·∫ßn)',
            'B√¨nh th∆∞·ªùng (trong 2-3 tu·∫ßn)',
            'Kh√¥ng g·∫•p (trong 1 th√°ng)',
            'L√™n k·∫ø ho·∫°ch tr∆∞·ªõc'
          ],
          category: 'product_specific',
          priority: 'medium',
          helpText: 'Gi√∫p ng√¢n h√†ng ∆∞u ti√™n x·ª≠ l√Ω h·ªì s∆° ph√π h·ª£p',
          icon: '‚ö°'
        }
      ]
    },
    {
      id: 'credit',
      name: 'L·ªãch s·ª≠ t√≠n d·ª•ng',
      description: 'Th√¥ng tin v·ªÅ c√°c kho·∫£n vay v√† th·∫ª t√≠n d·ª•ng hi·ªán c√≥',
      icon: 'üìà',
      questions: [
        {
          id: 'existing_loans',
          type: 'select',
          label: 'Kho·∫£n vay hi·ªán c√≥',
          required: true,
          options: [
            'Kh√¥ng c√≥ kho·∫£n vay n√†o',
            'C√≥ 1 kho·∫£n vay',
            'C√≥ 2-3 kho·∫£n vay',
            'C√≥ tr√™n 3 kho·∫£n vay'
          ],
          category: 'credit',
          priority: 'high',
          icon: 'üí≥'
        },
        {
          id: 'total_monthly_debt_payment',
          type: 'currency',
          label: 'T·ªïng s·ªë ti·ªÅn tr·∫£ n·ª£ h√†ng th√°ng',
          placeholder: '5,000,000',
          required: false,
          category: 'credit',
          priority: 'high',
          dependsOn: 'existing_loans',
          showWhen: (value) => value !== 'Kh√¥ng c√≥ kho·∫£n vay n√†o',
          helpText: 'Bao g·ªìm t·∫•t c·∫£ c√°c kho·∫£n vay: nh√†, xe, th·∫ª t√≠n d·ª•ng, vay c√° nh√¢n',
          icon: 'üí∞'
        },
        {
          id: 'credit_cards_count',
          type: 'select',
          label: 'S·ªë th·∫ª t√≠n d·ª•ng hi·ªán c√≥',
          required: true,
          options: [
            'Kh√¥ng c√≥ th·∫ª t√≠n d·ª•ng',
            '1 th·∫ª',
            '2-3 th·∫ª',
            '4-5 th·∫ª',
            'Tr√™n 5 th·∫ª'
          ],
          category: 'credit',
          priority: 'high',
          icon: 'üí≥'
        },
        {
          id: 'credit_card_usage',
          type: 'select',
          label: 'M·ª©c ƒë·ªô s·ª≠ d·ª•ng th·∫ª t√≠n d·ª•ng',
          required: false,
          options: [
            'S·ª≠ d·ª•ng √≠t (d∆∞·ªõi 30% h·∫°n m·ª©c)',
            'S·ª≠ d·ª•ng v·ª´a ph·∫£i (30-70% h·∫°n m·ª©c)',
            'S·ª≠ d·ª•ng nhi·ªÅu (tr√™n 70% h·∫°n m·ª©c)',
            'Lu√¥n s·ª≠ d·ª•ng h·∫øt h·∫°n m·ª©c',
            'Th∆∞·ªùng xuy√™n thanh to√°n thi·∫øu'
          ],
          category: 'credit',
          priority: 'medium',
          dependsOn: 'credit_cards_count',
          showWhen: (value) => value !== 'Kh√¥ng c√≥ th·∫ª t√≠n d·ª•ng',
          icon: 'üìä'
        },
        {
          id: 'payment_history',
          type: 'select',
          label: 'L·ªãch s·ª≠ thanh to√°n',
          required: true,
          options: [
            'Lu√¥n thanh to√°n ƒë√∫ng h·∫°n',
            'Th·ªânh tho·∫£ng tr·ªÖ h·∫°n (1-2 l·∫ßn/nƒÉm)',
            'Th∆∞·ªùng xuy√™n tr·ªÖ h·∫°n (3-5 l·∫ßn/nƒÉm)',
            'R·∫•t th∆∞·ªùng xuy√™n tr·ªÖ h·∫°n (tr√™n 5 l·∫ßn/nƒÉm)',
            'Ch∆∞a c√≥ l·ªãch s·ª≠ t√≠n d·ª•ng'
          ],
          category: 'credit',
          priority: 'high',
          helpText: 'Bao g·ªìm t·∫•t c·∫£ c√°c kho·∫£n vay v√† th·∫ª t√≠n d·ª•ng',
          icon: '‚úÖ'
        },
        {
          id: 'blacklist_status',
          type: 'radio',
          label: 'B·∫°n c√≥ b·ªã CIC ghi n·ª£ x·∫•u kh√¥ng?',
          required: true,
          options: [
            'Kh√¥ng, t√¥i ch∆∞a bao gi·ªù b·ªã ghi n·ª£ x·∫•u',
            'C√≥, nh∆∞ng ƒë√£ thanh to√°n xong v√† ƒë∆∞·ª£c x√≥a',
            'C√≥, ƒëang trong danh s√°ch n·ª£ x·∫•u',
            'Kh√¥ng bi·∫øt r√µ t√¨nh tr·∫°ng c·ªßa m√¨nh'
          ],
          category: 'credit',
          priority: 'high',
          helpText: 'Th√¥ng tin n√†y gi√∫p ng√¢n h√†ng ƒë√°nh gi√° ch√≠nh x√°c h·ªì s∆°',
          icon: '‚ö†Ô∏è'
        }
      ]
    },
    {
      id: 'additional',
      name: 'Th√¥ng tin b·ªï sung',
      description: 'C√°c th√¥ng tin kh√°c gi√∫p ƒë√°nh gi√° h·ªì s∆° t·ªët h∆°n',
      icon: 'üìã',
      questions: [
        {
          id: 'preferred_bank',
          type: 'select',
          label: 'Ng√¢n h√†ng ∆∞u ti√™n',
          required: false,
          options: [
            'Kh√¥ng c√≥ ∆∞u ti√™n ƒë·∫∑c bi·ªát',
            'Vietcombank',
            'Techcombank',
            'BIDV',
            'VietinBank',
            'Agribank',
            'ACB',
            'Sacombank',
            'VPBank',
            'TPBank',
            'HDBank',
            'Kh√°c'
          ],
          category: 'additional',
          priority: 'low',
          icon: 'üè¶'
        },
        {
          id: 'relationship_with_bank',
          type: 'select',
          label: 'M·ªëi quan h·ªá v·ªõi ng√¢n h√†ng ∆∞u ti√™n',
          required: false,
          options: [
            'Kh√°ch h√†ng m·ªõi',
            'ƒê√£ c√≥ t√†i kho·∫£n ti·∫øt ki·ªám',
            'ƒê√£ c√≥ t√†i kho·∫£n l∆∞∆°ng',
            'ƒê√£ t·ª´ng vay v·ªën',
            'Kh√°ch h√†ng VIP/∆Øu ti√™n'
          ],
          category: 'additional',
          priority: 'low',
          dependsOn: 'preferred_bank',
          showWhen: (value) => value !== 'Kh√¥ng c√≥ ∆∞u ti√™n ƒë·∫∑c bi·ªát',
          icon: 'ü§ù'
        },
        {
          id: 'contact_preference',
          type: 'checkbox',
          label: 'Th·ªùi gian thu·∫≠n ti·ªán ƒë·ªÉ li√™n h·ªá',
          required: false,
          options: [
            'S√°ng (8:00-12:00)',
            'Chi·ªÅu (12:00-17:00)',
            'T·ªëi (17:00-20:00)',
            'Cu·ªëi tu·∫ßn',
            'Ch·ªâ nh·∫Øn tin SMS/Email'
          ],
          category: 'additional',
          priority: 'low',
          helpText: 'Gi√∫p t∆∞ v·∫•n vi√™n li√™n h·ªá ƒë√∫ng th·ªùi ƒëi·ªÉm b·∫°n r·∫£nh',
          icon: 'üìû'
        },
        {
          id: 'additional_notes',
          type: 'textarea',
          label: 'Ghi ch√∫ th√™m',
          placeholder: 'C√°c th√¥ng tin b·ªï sung kh√°c m√† b·∫°n mu·ªën chia s·∫ª...',
          required: false,
          category: 'additional',
          priority: 'low',
          validation: {
            maxLength: 1000,
            message: 'Ghi ch√∫ kh√¥ng ƒë∆∞·ª£c qu√° 1000 k√Ω t·ª±'
          },
          icon: 'üìù'
        }
      ]
    }
  ],
  smartValidation: {
    creditScoreEstimation: true,
    incomeVerification: true,
    riskAssessment: true
  }
};

export const optimizedQuestionnaires: Record<LoanProductType, OptimizedQuestionForm> = {
  credit_loan: creditConsumerLoanQuestionnaire, // Updated to use the new comprehensive questionnaire
  mortgage_loan: mortgageQuestionnaire,
  car_loan: carLoanQuestionnaire,
  business_loan: businessLoanQuestionnaire,
  education_loan: educationLoanQuestionnaire
};

// Utility functions for smart questionnaire handling
export const getQuestionnaireForProduct = (productType: LoanProductType): OptimizedQuestionForm => {
  return optimizedQuestionnaires[productType];
};

export const getHighPriorityQuestions = (questionnaire: OptimizedQuestionForm): OptimizedQuestion[] => {
  return questionnaire.categories
    .flatMap(category => category.questions)
    .filter(question => question.priority === 'high');
};

export const getConditionalQuestions = (
  questionnaire: OptimizedQuestionForm,
  formData: Record<string, any>
): OptimizedQuestion[] => {
  return questionnaire.categories
    .flatMap(category => category.questions)
    .filter(question => {
      if (!question.dependsOn || !question.showWhen) return true;
      const dependentValue = formData[question.dependsOn];
      return question.showWhen(dependentValue);
    });
};

export const validateQuestionResponse = (
  question: OptimizedQuestion,
  value: any
): { isValid: boolean; message?: string } => {
  if (question.required && (!value || value === '')) {
    return { isValid: false, message: `${question.label} l√† b·∫Øt bu·ªôc` };
  }

  if (question.validation && value) {
    const { min, max, pattern, message } = question.validation;
    
    if (question.type === 'number') {
      const numValue = Number(value);
      if (min && numValue < min) {
        return { isValid: false, message: message || `Gi√° tr·ªã t·ªëi thi·ªÉu l√† ${min}` };
      }
      if (max && numValue > max) {
        return { isValid: false, message: message || `Gi√° tr·ªã t·ªëi ƒëa l√† ${max}` };
      }
    }

    if (pattern && typeof value === 'string') {
      const regex = new RegExp(pattern);
      if (!regex.test(value)) {
        return { isValid: false, message: message || 'ƒê·ªãnh d·∫°ng kh√¥ng h·ª£p l·ªá' };
      }
    }
  }

  return { isValid: true };
};